(()=>{"use strict";let t=null;function e(e){t?t.originalInput=e:(t=function(t){const e=document.createElement("div");e.style.cssText="\n\t\tposition: absolute;\n\t\tz-index: 9999;\n\t\tbackground: white;\n\t\tborder: 1px solid #ccc;\n\t\tpadding: 10px;\n\t\tbox-shadow: 0 2px 5px rgba(0,0,0,0.2);\n\t\tdisplay: none;\n\t\tborder-radius: 4px;\n\t";const n=document.createElement("input");n.type="text",n.placeholder="Enter prompt for autocomplete...",n.style.width="200px",n.style.marginRight="5px",n.style.padding="5px";const o=document.createElement("select");o.innerHTML='\n\t\t<option value="gpt-3.5-turbo">GPT-3.5</option>\n\t\t<option value="gpt-4">GPT-4</option>\n\t\t<option value="claude-3.5">Claude 3.5</option>\n\t',o.style.padding="5px";const i=document.createElement("button");i.textContent="Submit",i.style.padding="5px";const a=document.createElement("a");return a.textContent="Settings",a.href=chrome.runtime.getURL("options.html"),a.id="go-to-options",a.style.cssText="\n\t\tdisplay: block;\n\t\tmargin-top: 5px;\n\t\tfont-size: 12px;\n\t\tcolor: #0066cc;\n\t\ttext-decoration: none;\n\t",e.appendChild(n),e.appendChild(o),e.appendChild(i),e.appendChild(a),e.input=n,e.modelSelect=o,e.submitButton=i,e.settingsLink=a,e.originalInput=t,e}(e),document.body.appendChild(t),function(t){async function e(){const e=t.input.value,o=t.modelSelect.value;console.log("I have been clicked");const i=await async function(t,e){return console.log("Start completiong",t,e),new Promise((n=>{chrome.runtime.sendMessage({action:"getCompletion",prompt:t,model:e},(t=>{console.log("REspoinse is",t),n(t.completion)}))}))}(e,o);t.originalInput.value=i,n()}t.submitButton.addEventListener("click",e),t.input.addEventListener("keydown",(t=>{"Enter"===t.key?(t.preventDefault(),e()):"Escape"===t.key&&(t.preventDefault(),n())})),t.settingsLink.addEventListener("click",(t=>{t.preventDefault(),chrome.runtime.sendMessage({action:"openSettingsPage"})}))}(t)),function(t){const e=t.originalInput.getBoundingClientRect();t.style.left=`${e.left+window.scrollX}px`,t.style.top=e.top+window.scrollY-t.offsetHeight-5+"px"}(t),t.style.display="block",t.input.focus()}function n(){t&&(t.style.display="none",t.originalInput.focus())}function o(t){"k"===t.key&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),e(t.target))}document.addEventListener("focusin",(t=>{const e=t.target;"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||e.addEventListener("keydown",o)})),document.addEventListener("focusout",(t=>{const e=t.target;"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||e.removeEventListener("keydown",o)})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&t&&(e.preventDefault(),n())})),document.addEventListener("click",(e=>{t&&!t.contains(e.target)&&e.target!==t.originalInput&&n()})),chrome.runtime.onMessage.addListener(((t,n,o)=>{if("activateAutocomplete"===t.action){const t=document.activeElement;(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&e(t)}}))})();